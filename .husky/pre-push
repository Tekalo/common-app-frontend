#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "\nğŸš€ Running pre-push hook..."

echo "\nğŸ”  Checking for storybook changes..."

# Get the name of the current branch
current_branch=$(git symbolic-ref --short HEAD)

# Run git diff to check if any files were changed in src/modules
git diff --name-only HEAD..origin/$current_branch | grep '^src/modules/' > /dev/null || true

# If exit status is 0, it means changes were found in src/modules
if [ $? -eq 0 ]; then
  echo "\nğŸ¨ Changes found in src/modules, building Storybook..."
  pnpm build-storybook
else
  echo "\nğŸš€ No changes found in src/modules, skipping Storybook build."
fi

echo "\nğŸ› ï¸  Building for edge..."

pnpm build:for-edge

